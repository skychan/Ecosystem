<?xml version="1.0" encoding="UTF-8"?>
<agent version="1" agentcomment="This is order agent." agentclassname="Order" agentparentclassname="" agentinterfaces="" agentimports="">
  <behaviorsteps>
    <behaviorstep x="35" y="109" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="Set the owner is add to the owner list" visibility="0" returntype="void" compiledname="addOwner" parameters="Object od" exceptions="">
      <label x="35" y="94" text="Add Owner"/>
    </behaviorstep>
    <behaviorstep x="323" y="45" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="ecosystem.PureDemander" watchannotationtargetfieldnames="need" watchannotationtriggercondition="$watchee.getNewOrder().equals($watcher)" watchannotationtriggerschedule="1" watchannotationtriggerdelta="0.3" watchannotationtriggerpriority="ScheduleParameters.LAST_PRIORITY" watchannotationpick="" comment="Select provider" visibility="0" returntype="" compiledname="Select" parameters="ecosystem.PureDemander watchedAgent" exceptions="">
      <label x="323" y="30" text="Select provider"/>
    </behaviorstep>
    <behaviorstep x="635" y="57" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="ecosystem.Service" watchannotationtargetfieldnames="compete" watchannotationtriggercondition="$watchee.getCompete().equals($watcher)" watchannotationtriggerschedule="1" watchannotationtriggerdelta="0.1" watchannotationtriggerpriority="ScheduleParameters.FIRST_PRIORITY" watchannotationpick="" comment="Add the competitor" visibility="0" returntype="def" compiledname="AddCompetitor" parameters="ecosystem.Service watchedAgent" exceptions="">
      <label x="635" y="42" text="Add competitor"/>
    </behaviorstep>
    <behaviorstep x="240" y="236" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="Supplier Evaluation" visibility="0" returntype="def" compiledname="Evaluation" parameters="" exceptions="">
      <label x="240" y="221" text="Supplier Evaluation"/>
    </behaviorstep>
    <behaviorstep x="552" y="462" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="ecosystem.Service" watchannotationtargetfieldnames="finish" watchannotationtriggercondition="$watchee.getOrder().equals($watcher)" watchannotationtriggerschedule="0" watchannotationtriggerdelta="" watchannotationtriggerpriority="" watchannotationpick="" comment="Review the transaction" visibility="0" returntype="def" compiledname="Review" parameters="ecosystem.Service watchedAgent" exceptions="">
      <label x="552" y="447" text="Review"/>
    </behaviorstep>
  </behaviorsteps>
  <tasksteps>
    <taskstep x="36" y="186" comment="add owner to the list" command1="this.getOwnerList().add(od)" command2="" command3="" command4="" command5="">
      <label x="36" y="171" text="add owner to list"/>
    </taskstep>
    <taskstep x="325" y="132" comment="Select proper supplier with evaluation" command1="println &quot;candidates are &quot;+this.getCandidates()" command2="Evaluation()" command3="println &quot;after sort we have &quot; +this.getCandidates()" command4="this.setAllocatedService(this.getCandidates()[0])" command5="this.getAllocatedService().getJobList().add(this)">
      <label x="325" y="117" text="Evaluation and selection"/>
    </taskstep>
    <taskstep x="633" y="146" comment="Add to the temp candidates list" command1="this.candidates &lt;&lt; watchedAgent" command2="println &quot;just add &quot;+ watchedAgent" command3="" command4="" command5="">
      <label x="633" y="131" text="add competitor"/>
    </taskstep>
    <taskstep x="326" y="217" comment="Reset the candidates after selection" command1="this.candidates.clear()" command2="" command3="" command4="System.out.println(&quot;Provider Chosen: &quot;+this.allocatedService)" command5="">
      <label x="326" y="202" text="Reset"/>
    </taskstep>
    <taskstep x="241" y="321" comment="This is a task." command1="this.getCandidates().sort{[it.jobList.size(),it.jobList[0]]}" command2="" command3="" command4="" command5="">
      <label x="241" y="306" text="Do Task"/>
    </taskstep>
    <taskstep x="551" y="563" comment="Review and Commit" command1="println &quot;review and commit&quot;" command2="def rvalue = 0" command3="watchedAgent.AddReview(rvalue)" command4="" command5="">
      <label x="551" y="548" text="Review and commit"/>
    </taskstep>
  </tasksteps>
  <decisionsteps/>
  <joinsteps/>
  <agentproperties>
    <agentproperty x="42" y="34" comment="The order owner, if not only one" visibility="0" compiledname="ownerList" type="ArrayList" defaultvalue="new ArrayList()">
      <label x="47" y="19" text="Owner List"/>
    </agentproperty>
    <agentproperty x="128" y="35" comment="The order amount" visibility="0" compiledname="amount" type="int" defaultvalue="0">
      <label x="133" y="20" text="Amount"/>
    </agentproperty>
    <agentproperty x="250" y="124" comment="Record the allocated service" visibility="0" compiledname="allocatedService" type="Service" defaultvalue="null">
      <label x="255" y="109" text="Service"/>
    </agentproperty>
    <agentproperty x="528" y="47" comment="Record the candidates" visibility="0" compiledname="candidates" type="def" defaultvalue="[]">
      <label x="533" y="32" text="Candidates"/>
    </agentproperty>
    <agentproperty x="131" y="126" comment="Record the current owner" visibility="0" compiledname="owner" type="def" defaultvalue="null">
      <label x="136" y="111" text="Current owner"/>
    </agentproperty>
  </agentproperties>
  <endsteps>
    <endstep x="41" y="304"/>
    <endstep x="331" y="327"/>
    <endstep x="647" y="274"/>
    <endstep x="249" y="438"/>
    <endstep x="558" y="671"/>
  </endsteps>
  <connections>
    <transitions>
      <transition>
        <transitionsource type="behavior" index="0" anchor="0"/>
        <transitiontarget type="task" index="0" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="1" anchor="0"/>
        <transitiontarget type="task" index="1" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="2" anchor="0"/>
        <transitiontarget type="task" index="2" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="3" anchor="0"/>
        <transitiontarget type="task" index="4" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="4" anchor="0"/>
        <transitiontarget type="task" index="5" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="0" anchor="2"/>
        <transitiontarget type="end" index="0" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="1" anchor="2"/>
        <transitiontarget type="task" index="3" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="2" anchor="2"/>
        <transitiontarget type="end" index="2" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="3" anchor="2"/>
        <transitiontarget type="end" index="1" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="4" anchor="2"/>
        <transitiontarget type="end" index="3" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="5" anchor="2"/>
        <transitiontarget type="end" index="4" anchor="0"/>
        <bendpoints/>
      </transition>
    </transitions>
    <booleantransitions/>
  </connections>
</agent>