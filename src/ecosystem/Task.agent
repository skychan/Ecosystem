<?xml version="1.0" encoding="UTF-8"?>
<agent version="1" agentcomment="This is an agent." agentclassname="Task" agentparentclassname="" agentinterfaces="" agentimports="">
  <behaviorsteps>
    <behaviorstep x="241" y="491" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="Processing the task every time" visibility="0" returntype="void" compiledname="Processing" parameters="" exceptions="">
      <label x="241" y="476" text="Processing"/>
    </behaviorstep>
    <behaviorstep x="327" y="491" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="This is the step behavior." visibility="0" returntype="void" compiledname="Select" parameters="String index" exceptions="">
      <label x="327" y="476" text="Selection"/>
    </behaviorstep>
    <behaviorstep x="70" y="41" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="This is the step behavior." visibility="0" returntype="void" compiledname="setParameters" parameters="tdata" exceptions="">
      <label x="70" y="26" text="Set Values"/>
    </behaviorstep>
    <behaviorstep x="432" y="554" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="Set the owner is add to the owner list" visibility="0" returntype="void" compiledname="addOwner" parameters="ownerID" exceptions="">
      <label x="432" y="539" text="Add Owner"/>
    </behaviorstep>
    <behaviorstep x="535" y="547" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="Set the owner is add to the owner list" visibility="0" returntype="void" compiledname="addMaster" parameters="masterID" exceptions="">
      <label x="535" y="532" text="Add Master"/>
    </behaviorstep>
    <behaviorstep x="580" y="28" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="ecosystem.Resource" watchannotationtargetfieldnames="compete" watchannotationtriggercondition="$watcher.toString() == $watchee.compete.toString()" watchannotationtriggerschedule="1" watchannotationtriggerdelta="0.2" watchannotationtriggerpriority="ScheduleParameters.LAST_PRIORITY" watchannotationpick="" comment="Select provider" visibility="0" returntype="" compiledname="Select" parameters="ecosystem.Resource watchedAgent" exceptions="">
      <label x="580" y="13" text="Select provider"/>
    </behaviorstep>
    <behaviorstep x="323" y="31" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="Supplier Evaluation" visibility="0" returntype="def" compiledname="Evaluation" parameters="" exceptions="">
      <label x="323" y="16" text="Supplier Evaluation"/>
    </behaviorstep>
    <behaviorstep x="447" y="26" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="ecosystem.Service" watchannotationtargetfieldnames="finish" watchannotationtriggercondition="$watchee.getOrder().equals($watcher)" watchannotationtriggerschedule="0" watchannotationtriggerdelta="" watchannotationtriggerpriority="" watchannotationpick="" comment="Review the transaction" visibility="0" returntype="def" compiledname="Review" parameters="ecosystem.Service watchedAgent" exceptions="">
      <label x="447" y="11" text="Review"/>
    </behaviorstep>
    <behaviorstep x="671" y="553" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="ecosystem.Resource" watchannotationtargetfieldnames="compete" watchannotationtriggercondition="$watcher.toString() == $watchee.compete.toString()" watchannotationtriggerschedule="1" watchannotationtriggerdelta="0.1" watchannotationtriggerpriority="" watchannotationpick="" comment="This is the step behavior." visibility="0" returntype="def" compiledname="addCandidates" parameters="ecosystem.Resource watchedAgent" exceptions="">
      <label x="671" y="538" text="Add candidates"/>
    </behaviorstep>
  </behaviorsteps>
  <tasksteps>
    <taskstep x="243" y="587" comment="This is a task." command1="int remaintime = this.getRemainingTime()" command2="remaintime--" command3="this.setRemainingTime(remaintime)" command4="" command5="">
      <label x="243" y="572" text="Processing"/>
    </taskstep>
    <taskstep x="327" y="597" comment="This is a task." command1="this.setSelectedResource(index)" command2="int remaintime = this.getProcessingTime().get(index)" command3="this.setRemainingTime(remaintime)" command4="" command5="">
      <label x="327" y="582" text="Selection"/>
    </taskstep>
    <taskstep x="430" y="632" comment="add owner to the list" command1="this.owner &lt;&lt; ownerID" command2="" command3="" command4="" command5="">
      <label x="430" y="617" text="set owner"/>
    </taskstep>
    <taskstep x="242" y="759" comment="send the task change status signal" command1="this.setFinish(true)" command2="" command3="" command4="" command5="">
      <label x="242" y="744" text="change task status"/>
    </taskstep>
    <taskstep x="533" y="625" comment="add master to the list" command1="this.master &lt;&lt; masterID" command2="" command3="" command4="" command5="">
      <label x="533" y="610" text="set master"/>
    </taskstep>
    <taskstep x="161" y="245" comment="This is a task." command1="this.needResourceCapacity &lt;&lt; data" command2="" command3="" command4="" command5="">
      <label x="161" y="230" text="Do Task"/>
    </taskstep>
    <taskstep x="582" y="115" comment="Select proper supplier with evaluation" command1="println &quot;candidates are &quot;+this.getCandidates()" command2="Evaluation()" command3="println &quot;after sort we have &quot; +this.getCandidates()" command4="this.setAllocatedService(this.getCandidates()[0])" command5="this.getAllocatedService().getJobList().add(this)">
      <label x="582" y="100" text="Evaluation and selection"/>
    </taskstep>
    <taskstep x="583" y="200" comment="Reset the candidates after selection" command1="this.candidates.clear()" command2="" command3="" command4="System.out.println(&quot;Provider Chosen: &quot;+this.allocatedService)" command5="">
      <label x="583" y="185" text="Reset"/>
    </taskstep>
    <taskstep x="324" y="116" comment="This is a task." command1="this.getCandidates().sort{[it.jobList.size(),it.jobList[0]]}" command2="" command3="" command4="" command5="">
      <label x="324" y="101" text="Do Task"/>
    </taskstep>
    <taskstep x="446" y="118" comment="Review and Commit" command1="println &quot;review and commit&quot;" command2="def rvalue = 0" command3="watchedAgent.AddReview(rvalue)" command4="" command5="">
      <label x="446" y="103" text="Review and commit"/>
    </taskstep>
    <taskstep x="163" y="51" comment="This is a task." command1="this.setProcessingTime(data.value)" command2="" command3="" command4="" command5="">
      <label x="163" y="36" text="Do Task"/>
    </taskstep>
    <taskstep x="63" y="236" comment="This is a task." command1="this.setCall(this.getNeedResourceCapacity())" command2="" command3="" command4="" command5="">
      <label x="63" y="221" text="Do Task"/>
    </taskstep>
    <taskstep x="661" y="743" comment="This is a task." command1="this.candidates[watchedAgent.getType()]&lt;&lt;watchedAgent" command2="" command3="" command4="" command5="">
      <label x="661" y="728" text="Do Task"/>
    </taskstep>
    <taskstep x="742" y="642" comment="This is a task." command1="this.candidates[watchedAgent.getType()] = watchedAgent" command2="" command3="" command4="" command5="">
      <label x="742" y="627" text="Do Task"/>
    </taskstep>
  </tasksteps>
  <decisionsteps>
    <decisionstep x="64" y="143" comment="This is a loop." criteria="data in tdata.value" branchType="while">
      <label x="64" y="128" text="loop"/>
    </decisionstep>
    <decisionstep x="242" y="665" comment="This is an agent decision." criteria="this.getRemainingTime()" branchType="if">
      <label x="242" y="650" text="Evaluate Criteria"/>
    </decisionstep>
    <decisionstep x="164" y="142" comment="This is an agent decision." criteria="data.key == &quot;p&quot;" branchType="if">
      <label x="164" y="127" text="Evaluate Criteria"/>
    </decisionstep>
    <decisionstep x="661" y="646" comment="This is an agent decision." criteria="this.candidates[watchedAgent.getType()]" branchType="if">
      <label x="661" y="631" text="Evaluate Criteria"/>
    </decisionstep>
  </decisionsteps>
  <joinsteps/>
  <agentproperties>
    <agentproperty x="35" y="446" comment="This is an agent property." visibility="0" compiledname="type" type="def" defaultvalue="-1">
      <label x="40" y="431" text="Type"/>
    </agentproperty>
    <agentproperty x="113" y="448" comment="This is an agent property." visibility="0" compiledname="needResourceCapacity" type="def" defaultvalue="[:]">
      <label x="118" y="433" text="NeedResourceCapacity"/>
    </agentproperty>
    <agentproperty x="34" y="522" comment="This is an agent property." visibility="0" compiledname="processingTime" type="int" defaultvalue="0">
      <label x="39" y="507" text="ProcessingTime"/>
    </agentproperty>
    <agentproperty x="28" y="614" comment="This is an agent property." visibility="0" compiledname="selectedResource" type="String" defaultvalue="&quot;&quot;">
      <label x="33" y="599" text="Selected Resource"/>
    </agentproperty>
    <agentproperty x="29" y="693" comment="This is an agent property." visibility="0" compiledname="remainingTime" type="int" defaultvalue="-1">
      <label x="34" y="678" text="RemainingTime"/>
    </agentproperty>
    <agentproperty x="428" y="485" comment="Record the owners of the task" visibility="0" compiledname="owner" type="def" defaultvalue="[]">
      <label x="433" y="470" text="Owners"/>
    </agentproperty>
    <agentproperty x="154" y="555" comment="the mark of the task stage" visibility="0" compiledname="finish" type="boolean" defaultvalue="false">
      <label x="159" y="540" text="Finish"/>
    </agentproperty>
    <agentproperty x="531" y="478" comment="Record the master of the task" visibility="0" compiledname="master" type="def" defaultvalue="[]">
      <label x="536" y="463" text="Master"/>
    </agentproperty>
    <agentproperty x="167" y="329" comment="Denote calling for the new resources" visibility="0" compiledname="call" type="def" defaultvalue="0">
      <label x="172" y="314" text="Call"/>
    </agentproperty>
    <agentproperty x="681" y="475" comment="Record the candidates" visibility="0" compiledname="candidates" type="def" defaultvalue="[:]">
      <label x="686" y="460" text="Candidates"/>
    </agentproperty>
  </agentproperties>
  <endsteps>
    <endstep x="353" y="752"/>
    <endstep x="243" y="872"/>
    <endstep x="69" y="344"/>
    <endstep x="437" y="782"/>
    <endstep x="544" y="774"/>
    <endstep x="591" y="310"/>
    <endstep x="336" y="221"/>
    <endstep x="454" y="223"/>
    <endstep x="659" y="852"/>
  </endsteps>
  <connections>
    <transitions>
      <transition>
        <transitionsource type="behavior" index="0" anchor="0"/>
        <transitiontarget type="task" index="0" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="1" anchor="0"/>
        <transitiontarget type="task" index="1" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="2" anchor="0"/>
        <transitiontarget type="decision" index="0" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="3" anchor="0"/>
        <transitiontarget type="task" index="2" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="4" anchor="0"/>
        <transitiontarget type="task" index="4" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="5" anchor="0"/>
        <transitiontarget type="task" index="6" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="6" anchor="0"/>
        <transitiontarget type="task" index="8" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="7" anchor="0"/>
        <transitiontarget type="task" index="9" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="0" anchor="2"/>
        <transitiontarget type="decision" index="1" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="1" anchor="2"/>
        <transitiontarget type="end" index="0" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="2" anchor="2"/>
        <transitiontarget type="end" index="3" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="3" anchor="2"/>
        <transitiontarget type="end" index="1" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="4" anchor="2"/>
        <transitiontarget type="end" index="4" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="6" anchor="2"/>
        <transitiontarget type="task" index="7" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="7" anchor="2"/>
        <transitiontarget type="end" index="5" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="8" anchor="2"/>
        <transitiontarget type="end" index="6" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="9" anchor="2"/>
        <transitiontarget type="end" index="7" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="11" anchor="2"/>
        <transitiontarget type="end" index="2" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="8" anchor="0"/>
        <transitiontarget type="decision" index="3" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="12" anchor="2"/>
        <transitiontarget type="end" index="8" anchor="0"/>
        <bendpoints/>
      </transition>
    </transitions>
    <booleantransitions>
      <booleantransition value="true">
        <transitionsource type="decision" index="0" anchor="3"/>
        <transitiontarget type="decision" index="2" anchor="1"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="false">
        <transitionsource type="decision" index="0" anchor="2"/>
        <transitiontarget type="task" index="11" anchor="0"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="true">
        <transitionsource type="decision" index="1" anchor="2"/>
        <transitiontarget type="task" index="3" anchor="0"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="true">
        <transitionsource type="decision" index="2" anchor="0"/>
        <transitiontarget type="task" index="10" anchor="2"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="false">
        <transitionsource type="decision" index="2" anchor="2"/>
        <transitiontarget type="task" index="5" anchor="0"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="true">
        <transitionsource type="decision" index="3" anchor="2"/>
        <transitiontarget type="task" index="12" anchor="0"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="false">
        <transitionsource type="decision" index="3" anchor="3"/>
        <transitiontarget type="task" index="13" anchor="1"/>
        <bendpoints/>
      </booleantransition>
    </booleantransitions>
  </connections>
</agent>