<?xml version="1.0" encoding="UTF-8"?>
<agent version="1" agentcomment="This is an agent." agentclassname="Resource" agentparentclassname="" agentinterfaces="" agentimports="">
  <behaviorsteps>
    <behaviorstep x="1105" y="618" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="This is the step behavior." visibility="0" returntype="void" compiledname="Occupy" parameters="int amount" exceptions="">
      <label x="1105" y="603" text="Occupy"/>
    </behaviorstep>
    <behaviorstep x="982" y="100" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="This is the step behavior." visibility="0" returntype="void" compiledname="Release" parameters="int amount" exceptions="">
      <label x="982" y="85" text="Release"/>
    </behaviorstep>
    <behaviorstep x="1106" y="117" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="This is the step behavior." visibility="0" returntype="void" compiledname="Bid" parameters="int cost" exceptions="">
      <label x="1106" y="102" text="Adjust Cost"/>
    </behaviorstep>
    <behaviorstep x="573" y="140" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="Set the owner is add to the owner list" visibility="0" returntype="void" compiledname="addMaster" parameters="masterID" exceptions="">
      <label x="573" y="125" text="Add Master"/>
    </behaviorstep>
    <behaviorstep x="467" y="138" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="Set the owner is add to the owner list" visibility="0" returntype="void" compiledname="addOwner" parameters="ownerID" exceptions="">
      <label x="467" y="123" text="Add Owner"/>
    </behaviorstep>
    <behaviorstep x="65" y="171" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="ecosystem.Task" watchannotationtargetfieldnames="call" watchannotationtriggercondition="$watchee.Exist($watcher.getType())" watchannotationtriggerschedule="1" watchannotationtriggerdelta="0.1" watchannotationtriggerpriority="" watchannotationpick="" comment="Response to the need call" visibility="0" returntype="def" compiledname="Response" parameters="ecosystem.Task watchedAgent" exceptions="">
      <label x="65" y="156" text="Response"/>
    </behaviorstep>
    <behaviorstep x="453" y="415" scheduleannotationstart="1" scheduleannotationpick="" scheduleannotationinterval="1" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="0" watchannotationtriggerdelta="" watchannotationtriggerpriority="" watchannotationpick="" comment="Begin to process" visibility="0" returntype="def" compiledname="Process" parameters="" exceptions="">
      <label x="453" y="400" text="Process"/>
    </behaviorstep>
    <behaviorstep x="869" y="406" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="Change the service rank with depends on the review" visibility="0" returntype="def" compiledname="AdjustRank" parameters="" exceptions="">
      <label x="869" y="391" text="Adjust the service rank"/>
    </behaviorstep>
    <behaviorstep x="754" y="403" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="Add review to history" visibility="0" returntype="def" compiledname="AddReview" parameters="rvalue" exceptions="">
      <label x="754" y="388" text="Add review"/>
    </behaviorstep>
    <behaviorstep x="39" y="607" scheduleannotationstart="" scheduleannotationpick="" scheduleannotationinterval="" scheduleannotationpriority="" scheduleannotationduration="" scheduleannotationshuffle="0" watchannotationid="" watchannotationquery="" watchannotationtargetclassname="" watchannotationtargetfieldnames="" watchannotationtriggercondition="" watchannotationtriggerschedule="1" watchannotationtriggerdelta="1" watchannotationtriggerpriority="" watchannotationpick="" comment="After select, just wait for other resource to get ready" visibility="0" returntype="def" compiledname="Prepare" parameters="needCapacity" exceptions="">
      <label x="39" y="592" text="Prepare"/>
    </behaviorstep>
  </behaviorsteps>
  <tasksteps>
    <taskstep x="1105" y="717" comment="This is a task." command1="int temp = this.getAvailable()" command2="temp -= amount" command3="this.setAvailable(temp)" command4="" command5="">
      <label x="1105" y="702" text="Occupying"/>
    </taskstep>
    <taskstep x="983" y="210" comment="This is a task." command1="" command2="temp -= amount" command3="this.setAvailable(temp)" command4="" command5="">
      <label x="983" y="195" text="Releasing"/>
    </taskstep>
    <taskstep x="1104" y="201" comment="This is a task." command1="this.setUnitCost(cost)" command2="" command3="" command4="" command5="">
      <label x="1104" y="186" text="Adjust bid"/>
    </taskstep>
    <taskstep x="571" y="218" comment="add master to the list" command1="this.master &lt;&lt; masterID" command2="" command3="" command4="" command5="">
      <label x="571" y="203" text="set master"/>
    </taskstep>
    <taskstep x="464" y="222" comment="add owner to the list" command1="this.owner &lt;&lt; ownerID" command2="" command3="" command4="" command5="">
      <label x="464" y="207" text="set owner"/>
    </taskstep>
    <taskstep x="64" y="335" comment="change the compete state" command1="" command2="" command3="this.setCompete(watchedAgent)" command4="" command5="println this.toString() + &quot;type &quot; + this.getType() + &quot; is competing for &quot;+ compete.getType()">
      <label x="64" y="320" text="Change the comoete state"/>
    </taskstep>
    <taskstep x="557" y="841" comment="The finish step" command1="this.setFinish(this.getFinish()+1)" command2="System.out.println(theTask.toString()+&quot; Finished&quot;)" command3="this.getJobList().remove(theTask)" command4="this.readyTask.remove(theTask)" command5="">
      <label x="557" y="826" text="Afterward"/>
    </taskstep>
    <taskstep x="452" y="578" comment="Continue" command1="System.out.println(&quot;continue to process &quot;+this.getOrder().toString())" command2="" command3="" command4="" command5="">
      <label x="452" y="563" text="Continue"/>
    </taskstep>
    <taskstep x="870" y="501" comment="This is a task." command1="" command2="" command3="" command4="" command5="">
      <label x="870" y="486" text="Do Task"/>
    </taskstep>
    <taskstep x="755" y="498" comment="This is a task." command1="println &quot;add demander&apos;s review to the history&quot;" command2="this.reviews &lt;&lt; rvalue" command3="" command4="" command5="">
      <label x="755" y="483" text="Do Task"/>
    </taskstep>
    <taskstep x="133" y="690" comment="This is a task." command1="this.setReady(false)" command2="" command3="" command4="" command5="">
      <label x="133" y="675" text="Do Task"/>
    </taskstep>
    <taskstep x="37" y="777" comment="This is a task." command1="this.setReady(true)" command2="" command3="" command4="" command5="">
      <label x="37" y="762" text="Do Task"/>
    </taskstep>
    <taskstep x="557" y="661" comment="This is a task." command1="theTask.setProcessingTime(theTask.getProcessingTime()-1)" command2="" command3="" command4="" command5="">
      <label x="557" y="646" text="Do Task"/>
    </taskstep>
  </tasksteps>
  <decisionsteps>
    <decisionstep x="63" y="243" comment="Decide to take the task or not" criteria="true" branchType="if">
      <label x="63" y="228" text="Take it or not"/>
    </decisionstep>
    <decisionstep x="451" y="488" comment="Have ready tasks or not" criteria="this.getReadyTask().size()&gt;0" branchType="if">
      <label x="451" y="473" text="Have ready tasks"/>
    </decisionstep>
    <decisionstep x="38" y="691" comment="This is an agent decision." criteria="this.getAvailablity() &lt; needCapacity" branchType="if">
      <label x="38" y="676" text="Evaluate Criteria"/>
    </decisionstep>
    <decisionstep x="453" y="660" comment="This is a loop." criteria="theTask in this.readyTask" branchType="while">
      <label x="453" y="645" text="Evaluate Criteria"/>
    </decisionstep>
    <decisionstep x="557" y="741" comment="Check if the job is finished" criteria="theTask.getProcessingTime()&lt;=0" branchType="if">
      <label x="557" y="726" text="Check finish"/>
    </decisionstep>
  </decisionsteps>
  <joinsteps/>
  <agentproperties>
    <agentproperty x="69" y="67" comment="This is an agent property." visibility="0" compiledname="type" type="def" defaultvalue="0">
      <label x="74" y="52" text="Type"/>
    </agentproperty>
    <agentproperty x="1001" y="626" comment="This is an agent property." visibility="0" compiledname="unitCost" type="int" defaultvalue="0">
      <label x="1006" y="611" text="Unit Cost"/>
    </agentproperty>
    <agentproperty x="1110" y="544" comment="This is an agent property." visibility="0" compiledname="available" type="int" defaultvalue="this.getCapacity()">
      <label x="1115" y="529" text="Available"/>
    </agentproperty>
    <agentproperty x="569" y="71" comment="Record the master of the resource" visibility="0" compiledname="master" type="def" defaultvalue="[]">
      <label x="574" y="56" text="Master"/>
    </agentproperty>
    <agentproperty x="237" y="184" comment="The capacity of the service" visibility="0" compiledname="capacity" type="int" defaultvalue="0">
      <label x="242" y="169" text="Capacity"/>
    </agentproperty>
    <agentproperty x="467" y="69" comment="The service owner, if not only one" visibility="0" compiledname="owner" type="def" defaultvalue="[]">
      <label x="472" y="54" text="Owner"/>
    </agentproperty>
    <agentproperty x="305" y="182" comment="The service unit cost" visibility="0" compiledname="cost" type="int" defaultvalue="0">
      <label x="310" y="167" text="Unit Cost"/>
    </agentproperty>
    <agentproperty x="151" y="69" comment="The var to record compete order" visibility="0" compiledname="compete" type="def" defaultvalue="[]">
      <label x="156" y="54" text="Compete"/>
    </agentproperty>
    <agentproperty x="315" y="70" comment="Record be chose or not" visibility="0" compiledname="chose" type="boolean" defaultvalue="false">
      <label x="320" y="55" text="Chose"/>
    </agentproperty>
    <agentproperty x="304" y="413" comment="The Order(Task) mark" visibility="0" compiledname="order" type="Order" defaultvalue="null">
      <label x="309" y="398" text="Order Mark"/>
    </agentproperty>
    <agentproperty x="1049" y="405" comment="Count the finished jobs" visibility="0" compiledname="finish" type="int" defaultvalue="0">
      <label x="1054" y="390" text="Finished"/>
    </agentproperty>
    <agentproperty x="222" y="414" comment="Job list" visibility="0" compiledname="jobList" type="def" defaultvalue="[]">
      <label x="227" y="399" text="Job List"/>
    </agentproperty>
    <agentproperty x="221" y="487" comment="Mark the status of processing or not" visibility="0" compiledname="processing" type="boolean" defaultvalue="false">
      <label x="226" y="472" text="Processing ?"/>
    </agentproperty>
    <agentproperty x="807" y="288" comment="Quality" visibility="0" compiledname="quality" type="def" defaultvalue="0">
      <label x="812" y="273" text="Quality"/>
    </agentproperty>
    <agentproperty x="892" y="289" comment="Review history" visibility="0" compiledname="reviews" type="def" defaultvalue="[]">
      <label x="897" y="274" text="Review History"/>
    </agentproperty>
    <agentproperty x="707" y="287" comment="Mark the Rank value" visibility="0" compiledname="rank" type="def" defaultvalue="0">
      <label x="712" y="272" text="Rank"/>
    </agentproperty>
    <agentproperty x="234" y="276" comment="Record the available capacity" visibility="0" compiledname="availablity" type="int" defaultvalue="this.getCapacity()">
      <label x="239" y="261" text="Availablity"/>
    </agentproperty>
    <agentproperty x="132" y="602" comment="The ready mark" visibility="0" compiledname="ready" type="boolean" defaultvalue="false">
      <label x="137" y="587" text="Ready"/>
    </agentproperty>
    <agentproperty x="306" y="490" comment="The ready task mark" visibility="0" compiledname="readyTask" type="def" defaultvalue="[]">
      <label x="311" y="475" text="Ready Task"/>
    </agentproperty>
  </agentproperties>
  <endsteps>
    <endstep x="1124" y="825"/>
    <endstep x="1008" y="341"/>
    <endstep x="1128" y="336"/>
    <endstep x="594" y="344"/>
    <endstep x="482" y="342"/>
    <endstep x="82" y="454"/>
    <endstep x="905" y="628"/>
    <endstep x="785" y="638"/>
    <endstep x="59" y="886"/>
    <endstep x="473" y="769"/>
  </endsteps>
  <connections>
    <transitions>
      <transition>
        <transitionsource type="behavior" index="0" anchor="0"/>
        <transitiontarget type="task" index="0" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="1" anchor="0"/>
        <transitiontarget type="task" index="1" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="2" anchor="0"/>
        <transitiontarget type="task" index="2" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="3" anchor="0"/>
        <transitiontarget type="task" index="3" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="4" anchor="0"/>
        <transitiontarget type="task" index="4" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="5" anchor="0"/>
        <transitiontarget type="decision" index="0" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="6" anchor="0"/>
        <transitiontarget type="decision" index="1" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="7" anchor="0"/>
        <transitiontarget type="task" index="8" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="8" anchor="0"/>
        <transitiontarget type="task" index="9" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="behavior" index="9" anchor="0"/>
        <transitiontarget type="decision" index="2" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="0" anchor="2"/>
        <transitiontarget type="end" index="0" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="1" anchor="2"/>
        <transitiontarget type="end" index="1" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="2" anchor="2"/>
        <transitiontarget type="end" index="2" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="3" anchor="2"/>
        <transitiontarget type="end" index="3" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="4" anchor="2"/>
        <transitiontarget type="end" index="4" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="5" anchor="2"/>
        <transitiontarget type="end" index="5" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="7" anchor="2"/>
        <transitiontarget type="decision" index="3" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="8" anchor="2"/>
        <transitiontarget type="end" index="6" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="9" anchor="2"/>
        <transitiontarget type="end" index="7" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="11" anchor="2"/>
        <transitiontarget type="end" index="8" anchor="0"/>
        <bendpoints/>
      </transition>
      <transition>
        <transitionsource type="task" index="12" anchor="2"/>
        <transitiontarget type="decision" index="4" anchor="0"/>
        <bendpoints/>
      </transition>
    </transitions>
    <booleantransitions>
      <booleantransition value="true">
        <transitionsource type="decision" index="0" anchor="2"/>
        <transitiontarget type="task" index="5" anchor="0"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="true">
        <transitionsource type="decision" index="1" anchor="2"/>
        <transitiontarget type="task" index="7" anchor="0"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="true">
        <transitionsource type="decision" index="2" anchor="3"/>
        <transitiontarget type="task" index="10" anchor="1"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="false">
        <transitionsource type="decision" index="2" anchor="2"/>
        <transitiontarget type="task" index="11" anchor="0"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="true">
        <transitionsource type="decision" index="3" anchor="3"/>
        <transitiontarget type="task" index="12" anchor="1"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="false">
        <transitionsource type="decision" index="3" anchor="2"/>
        <transitiontarget type="end" index="9" anchor="0"/>
        <bendpoints/>
      </booleantransition>
      <booleantransition value="true">
        <transitionsource type="decision" index="4" anchor="2"/>
        <transitiontarget type="task" index="6" anchor="0"/>
        <bendpoints/>
      </booleantransition>
    </booleantransitions>
  </connections>
</agent>